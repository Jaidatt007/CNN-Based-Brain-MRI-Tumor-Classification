{% extends "base.html" %}

{% block content %}
<style>
    .results-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .result-header {
        text-align: center;
        margin-bottom: 3rem;
    }

    .result-header h1 {
        font-size: 2.5rem;
        font-weight: 700;
        color: white;
        margin-bottom: 0.5rem;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    .result-header p {
        color: rgba(255, 255, 255, 0.9);
        font-size: 1.1rem;
    }

    .results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 2rem;
        margin-bottom: 2rem;
    }

    .result-card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 24px;
        padding: 2rem;
        box-shadow: 
            0 20px 60px rgba(0, 0, 0, 0.15),
            0 0 0 1px rgba(255, 255, 255, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.3);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }

    .result-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
    }

    .result-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 25px 70px rgba(0, 0, 0, 0.2);
    }

    .card-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #2d3748;
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .card-title i {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .mri-image-container {
        position: relative;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
        margin-bottom: 1rem;
    }

    .mri-image-container img {
        width: 100%;
        height: auto;
        display: block;
        transition: transform 0.3s ease;
    }

    .mri-image-container:hover img {
        transform: scale(1.05);
    }

    .image-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to bottom, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
        display: flex;
        align-items: flex-end;
        padding: 1rem;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .mri-image-container:hover .image-overlay {
        opacity: 1;
    }

    .image-label {
        color: white;
        font-weight: 600;
        font-size: 0.9rem;
    }

    .prediction-box {
        background: linear-gradient(135deg, #e6fffa 0%, #f0e7ff 100%);
        border-radius: 16px;
        padding: 2rem;
        margin-bottom: 1.5rem;
        border: 2px solid #667eea;
    }

    .prediction-label {
        font-size: 0.9rem;
        color: #718096;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
    }

    .prediction-value {
        font-size: 2rem;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 1rem;
    }

    .prediction-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }

    .prediction-icon.tumor {
        color: #f56565;
    }

    .prediction-icon.no-tumor {
        color: #48bb78;
    }

    .confidence-section {
        margin-top: 1.5rem;
    }

    .confidence-label {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
    }

    .confidence-label span:first-child {
        font-size: 0.9rem;
        color: #718096;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .confidence-label span:last-child {
        font-size: 1.5rem;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .confidence-bar {
        height: 12px;
        background: #e2e8f0;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
    }

    .confidence-fill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        border-radius: 10px;
        transition: width 1.5s ease-out;
        width: 0;
        position: relative;
        overflow: hidden;
    }

    .confidence-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .chart-container {
        margin-top: 1.5rem;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    }

    .chart-container img {
        width: 100%;
        height: auto;
        display: block;
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
        margin-top: 1.5rem;
    }

    .info-item {
        background: #f7fafc;
        padding: 1rem;
        border-radius: 12px;
        border-left: 4px solid #667eea;
    }

    .info-item-label {
        font-size: 0.8rem;
        color: #718096;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: 0.25rem;
    }

    .info-item-value {
        font-size: 1.1rem;
        color: #2d3748;
        font-weight: 600;
    }

    .action-buttons {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
        margin-top: 2rem;
    }

    .btn-action {
        padding: 1rem;
        font-size: 1rem;
        font-weight: 600;
        border-radius: 12px;
        border: none;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }

    .btn-primary-custom {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-primary-custom:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
    }

    .btn-secondary-custom {
        background: white;
        color: #667eea;
        border: 2px solid #667eea;
    }

    .btn-secondary-custom:hover {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .alert-info {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(20px);
        border-radius: 16px;
        padding: 1.5rem;
        border-left: 6px solid #667eea;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        margin-top: 2rem;
    }

    .alert-info i {
        color: #667eea;
        font-size: 1.5rem;
        margin-right: 1rem;
    }

    .alert-info strong {
        color: #2d3748;
    }

    .alert-info p {
        color: #4a5568;
        margin: 0;
        line-height: 1.6;
    }

    @media (max-width: 768px) {
        .results-grid {
            grid-template-columns: 1fr;
        }

        .info-grid {
            grid-template-columns: 1fr;
        }
    }
</style>

<div class="results-container">
    <div class="result-header">
        <h1><i class="fas fa-check-circle me-2"></i>Analysis Complete</h1>
        <p>Review the detailed results of your MRI scan analysis below</p>
    </div>

    <div class="results-grid">
        <!-- MRI Image Card -->
        <div class="result-card">
            <h4 class="card-title">
                <i class="fas fa-image"></i>
                Uploaded MRI Scan
            </h4>
            <div class="mri-image-container">
                <img src="/{{ image_path }}" alt="MRI Scan">
                <div class="image-overlay">
                    <span class="image-label">Original MRI Image</span>
                </div>
            </div>
            <div class="info-grid">
                <div class="info-item">
                    <div class="info-item-label">Status</div>
                    <div class="info-item-value">Processed</div>
                </div>
                <div class="info-item">
                    <div class="info-item-label">Quality</div>
                    <div class="info-item-value">Verified</div>
                </div>
            </div>
        </div>

        <!-- Prediction Results Card -->
        <div class="result-card">
            <h4 class="card-title">
                <i class="fas fa-brain"></i>
                AI Prediction Results
            </h4>
            
            <div class="prediction-box">
                <div class="prediction-label">Diagnosis</div>
                <div class="prediction-icon {% if 'tumor' in prediction.lower() %}tumor{% else %}no-tumor{% endif %}">
                    <i class="fas {% if 'tumor' in prediction.lower() %}fa-check-circle{% else %}fa-exclamation-triangle{% endif %}"></i>
                </div>
                <div class="prediction-value">{{ prediction }}</div>
            </div>

            <div class="confidence-section">
                <div class="confidence-label">
                    <span>Confidence Level</span>
                    <span id="confidenceValue">{{ confidence }}%</span>
                </div>
                <div class="confidence-bar">
                    <div class="confidence-fill" id="confidenceFill" data-confidence="{{ confidence }}"></div>
                </div>
            </div>

            {% if chart_path %}
            <div class="chart-container">
                <img src="/{{ chart_path }}" alt="Confidence Chart">
            </div>
            {% endif %}
        </div>
    </div>

    <div class="alert-info">
        <div class="d-flex align-items-start">
            <i class="fas fa-info-circle"></i>
            <div>
                <strong>Important Medical Disclaimer</strong>
                <p class="mt-2">
                    This AI-powered analysis is designed to assist healthcare professionals and should not be used as the sole basis for medical diagnosis or treatment decisions. Always consult with qualified medical professionals for proper evaluation and interpretation of MRI scans. This tool is intended for research and educational purposes.
                </p>
            </div>
        </div>
    </div>

    <div class="action-buttons">
        <a href="/" class="btn-action btn-primary-custom">
            <i class="fas fa-upload"></i>
            Analyze Another Scan
        </a>
        <button onclick="window.print()" class="btn-action btn-secondary-custom">
            <i class="fas fa-download"></i>
            Download Report
        </button>
    </div>
</div>

<script>
    // Animate confidence bar on page load
    window.addEventListener('load', () => {
        const confidenceFill = document.getElementById('confidenceFill');
        const confidence = confidenceFill.getAttribute('data-confidence');
        
        setTimeout(() => {
            confidenceFill.style.width = confidence + '%';
        }, 300);
    });

    // Add subtle animation to cards
    const cards = document.querySelectorAll('.result-card');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, 200 * index);
    });
</script>
{% endblock %}